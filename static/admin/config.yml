backend:
  name: git-gateway
  branch: main # Branch to update (optional; defaults to master)

# These lines should *not* be indented
media_folder: "static/images/uploads" # Media files will be stored in the repo under static/images/uploads
public_folder: "/images/uploads" # The src attribute for uploaded media will begin with /images/uploads








# 内容集合配置

# 强化权限控制（移除access_control，改用工作流权限）
collections:
  - name: "blog"
    label: "文章"
    folder: "content/posts"
    create: true
    slug: "{{year}}-{{month}}-{{day}}-{{slug}}"
    publish_mode: editorial_workflow
    # 工作流与权限深度绑定
    workflow:
      - label: "草稿"
        name: "draft"
        meta: 
          status: "draft"
          permissions:  # 状态级权限控制
            create: ["writer", "editor", "admin"]
            update: ["writer", "editor", "admin"]
            delete: ["editor", "admin"]

      - label: "待审核"
        name: "pending"
        meta: 
          status: "pending"
          permissions:
            update: ["editor", "admin"]  # writer不能修改待审内容
            publish: ["admin"]          # 仅admin可发布

      - label: "已发布"
        name: "published"
        meta: 
          status: "published"
          permissions:
            update: ["admin"]           # 仅admin可修改已发布内容
            unpublish: ["admin"]

    fields:
      - label: "标题"
        name: "title"
        widget: "string"
        default: "文章标题"
        pattern: ['^.{2,100}$', "标题需2-100个字符"]

      - label: "时间"
        name: "date"
        widget: "datetime"
        format: "YYYY-MM-DDTHH:mm:ssZ"  # ISO 8601格式
        date_format: "YYYY-MM-DD"       # 显示格式
        time_format: "HH:mm:ss"         # 时间显示格式
        default: "2025-02-28T12:00:00Z"

      - label: "作者"
        name: "author"
        widget: "string"
        default: "未知"
        pattern: ['^.{1,50}$', "文章作者需1-50个字符"]

      - label: "标签"
        name: "tags"
        widget: "list"
        default: ["其他"]
        allow_add: true  # 允许添加新标签

      - label: "别名"
        name: "aliases"
        widget: "list"
        default: ["url"]
        allow_add: true  # 允许添加新标签
        required: false

      - label: "评论"
        name: "comments"
        widget: "boolean"
        default: false
        required: false
        hint: "是否允许用户评论此文章"

      - label: "内容"
        name: "body"
        widget: "markdown"

  - name: "generic_pages"
    label: "其他"
    folder: "content"
    create: true
    slug: "{{slug}}"
    access:
      - role: "admin"
    fields:
      - {label: "标题", name: "title", widget: "string"}
      - {label: "布局", name: "layout", widget: "string", default: "page"}
      - {label: "内容", name: "body", widget: "markdown"}

















